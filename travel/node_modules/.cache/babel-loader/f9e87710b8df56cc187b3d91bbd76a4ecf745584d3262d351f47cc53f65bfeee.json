{"ast":null,"code":"const Polynomial = require('./polynomial');\nfunction ReedSolomonEncoder(degree) {\n  this.genPoly = undefined;\n  this.degree = degree;\n  if (this.degree) this.initialize(this.degree);\n}\n\n/**\r\n * Initialize the encoder.\r\n * The input param should correspond to the number of error correction codewords.\r\n *\r\n * @param  {Number} degree\r\n */\nReedSolomonEncoder.prototype.initialize = function initialize(degree) {\n  // create an irreducible generator polynomial\n  this.degree = degree;\n  this.genPoly = Polynomial.generateECPolynomial(this.degree);\n};\n\n/**\r\n * Encodes a chunk of data\r\n *\r\n * @param  {Uint8Array} data Buffer containing input data\r\n * @return {Uint8Array}      Buffer containing encoded data\r\n */\nReedSolomonEncoder.prototype.encode = function encode(data) {\n  if (!this.genPoly) {\n    throw new Error('Encoder not initialized');\n  }\n\n  // Calculate EC for this data block\n  // extends data size to data+genPoly size\n  const paddedData = new Uint8Array(data.length + this.degree);\n  paddedData.set(data);\n\n  // The error correction codewords are the remainder after dividing the data codewords\n  // by a generator polynomial\n  const remainder = Polynomial.mod(paddedData, this.genPoly);\n\n  // return EC data blocks (last n byte, where n is the degree of genPoly)\n  // If coefficients number in remainder are less than genPoly degree,\n  // pad with 0s to the left to reach the needed number of coefficients\n  const start = this.degree - remainder.length;\n  if (start > 0) {\n    const buff = new Uint8Array(this.degree);\n    buff.set(remainder, start);\n    return buff;\n  }\n  return remainder;\n};\nmodule.exports = ReedSolomonEncoder;","map":{"version":3,"names":["Polynomial","require","ReedSolomonEncoder","degree","genPoly","undefined","initialize","prototype","generateECPolynomial","encode","data","Error","paddedData","Uint8Array","length","set","remainder","mod","start","buff","module","exports"],"sources":["C:/Users/zcy/Desktop/code/gztravel/travel/node_modules/qrcode/lib/core/reed-solomon-encoder.js"],"sourcesContent":["const Polynomial = require('./polynomial')\r\n\r\nfunction ReedSolomonEncoder (degree) {\r\n  this.genPoly = undefined\r\n  this.degree = degree\r\n\r\n  if (this.degree) this.initialize(this.degree)\r\n}\r\n\r\n/**\r\n * Initialize the encoder.\r\n * The input param should correspond to the number of error correction codewords.\r\n *\r\n * @param  {Number} degree\r\n */\r\nReedSolomonEncoder.prototype.initialize = function initialize (degree) {\r\n  // create an irreducible generator polynomial\r\n  this.degree = degree\r\n  this.genPoly = Polynomial.generateECPolynomial(this.degree)\r\n}\r\n\r\n/**\r\n * Encodes a chunk of data\r\n *\r\n * @param  {Uint8Array} data Buffer containing input data\r\n * @return {Uint8Array}      Buffer containing encoded data\r\n */\r\nReedSolomonEncoder.prototype.encode = function encode (data) {\r\n  if (!this.genPoly) {\r\n    throw new Error('Encoder not initialized')\r\n  }\r\n\r\n  // Calculate EC for this data block\r\n  // extends data size to data+genPoly size\r\n  const paddedData = new Uint8Array(data.length + this.degree)\r\n  paddedData.set(data)\r\n\r\n  // The error correction codewords are the remainder after dividing the data codewords\r\n  // by a generator polynomial\r\n  const remainder = Polynomial.mod(paddedData, this.genPoly)\r\n\r\n  // return EC data blocks (last n byte, where n is the degree of genPoly)\r\n  // If coefficients number in remainder are less than genPoly degree,\r\n  // pad with 0s to the left to reach the needed number of coefficients\r\n  const start = this.degree - remainder.length\r\n  if (start > 0) {\r\n    const buff = new Uint8Array(this.degree)\r\n    buff.set(remainder, start)\r\n\r\n    return buff\r\n  }\r\n\r\n  return remainder\r\n}\r\n\r\nmodule.exports = ReedSolomonEncoder\r\n"],"mappings":"AAAA,MAAMA,UAAU,GAAGC,OAAO,CAAC,cAAc,CAAC;AAE1C,SAASC,kBAAkBA,CAAEC,MAAM,EAAE;EACnC,IAAI,CAACC,OAAO,GAAGC,SAAS;EACxB,IAAI,CAACF,MAAM,GAAGA,MAAM;EAEpB,IAAI,IAAI,CAACA,MAAM,EAAE,IAAI,CAACG,UAAU,CAAC,IAAI,CAACH,MAAM,CAAC;AAC/C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACAD,kBAAkB,CAACK,SAAS,CAACD,UAAU,GAAG,SAASA,UAAUA,CAAEH,MAAM,EAAE;EACrE;EACA,IAAI,CAACA,MAAM,GAAGA,MAAM;EACpB,IAAI,CAACC,OAAO,GAAGJ,UAAU,CAACQ,oBAAoB,CAAC,IAAI,CAACL,MAAM,CAAC;AAC7D,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACAD,kBAAkB,CAACK,SAAS,CAACE,MAAM,GAAG,SAASA,MAAMA,CAAEC,IAAI,EAAE;EAC3D,IAAI,CAAC,IAAI,CAACN,OAAO,EAAE;IACjB,MAAM,IAAIO,KAAK,CAAC,yBAAyB,CAAC;EAC5C;;EAEA;EACA;EACA,MAAMC,UAAU,GAAG,IAAIC,UAAU,CAACH,IAAI,CAACI,MAAM,GAAG,IAAI,CAACX,MAAM,CAAC;EAC5DS,UAAU,CAACG,GAAG,CAACL,IAAI,CAAC;;EAEpB;EACA;EACA,MAAMM,SAAS,GAAGhB,UAAU,CAACiB,GAAG,CAACL,UAAU,EAAE,IAAI,CAACR,OAAO,CAAC;;EAE1D;EACA;EACA;EACA,MAAMc,KAAK,GAAG,IAAI,CAACf,MAAM,GAAGa,SAAS,CAACF,MAAM;EAC5C,IAAII,KAAK,GAAG,CAAC,EAAE;IACb,MAAMC,IAAI,GAAG,IAAIN,UAAU,CAAC,IAAI,CAACV,MAAM,CAAC;IACxCgB,IAAI,CAACJ,GAAG,CAACC,SAAS,EAAEE,KAAK,CAAC;IAE1B,OAAOC,IAAI;EACb;EAEA,OAAOH,SAAS;AAClB,CAAC;AAEDI,MAAM,CAACC,OAAO,GAAGnB,kBAAkB","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}